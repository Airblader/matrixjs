function d(a){throw a;}var h=!0,k=null,l=!1,m=this;Math.random();function p(a,b){var c=a.split("."),e=m;!(c[0]in e)&&e.execScript&&e.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)!c.length&&void 0!==b?e[f]=b:e=e[f]?e[f]:e[f]={}};function q(a){var b=[].slice.call(arguments),c,e,f=[];this.t=function(b){return f[b]};this.u=function(b,a){f[b]=a;return this};this.a=function(){return{rows:c,b:e}};(function(){if(1===b.length&&b[0]instanceof Array&&0!==b[0].length&&b[0][0]instanceof Array){c=b[0].length;e=-1;for(var a=0;a<b[0].length;a++){b[0][a].length!==e&&-1!==e&&d(new r(s.INVALID_PARAMETERS,"Number of columns must be the same for all rows"));u(b[0][a])||d(new r(s.INVALID_PARAMETERS,"Elements must be numbers"));e=Math.max(e,b[0][a].length);
for(var n=0;n<b[0][a].length;n++)f.push(b[0][a][n])}}else 1<=b.length&&3>=b.length&&b[0]instanceof Array&&(0===b[0].length||v(b[0][0]))?(u(b[0])||d(new r(s.INVALID_PARAMETERS,"Elements must be numbers")),f=b[0],a=b[1],n=b[2],!v(a)&&!v(n)?a=n=Math.sqrt(f.length):!v(a)&&w(n)?a=f.length/n:w(a)&&!v(n)&&(n=f.length/a),(!w(a)||!w(n))&&d(new r(s.OUT_OF_BOUNDS,"Array must represent square matrix if no size is given")),c=a,e=n):1===b.length&&w(b[0])?(c=b[0],e=b[0],f=x(c*e,0)):2===b.length&&w(b[0])&&w(b[1])?
(c=b[0],e=b[1],f=x(c*e,0)):d(new r(s.INVALID_PARAMETERS,"Parameters must match a supported signature"))})();return this}p("Matrix",q);var y={stringify:{O:"\r\n",z:"\t"},g:{mode:"both"},h:{C:0},l:{which:"max"},random:{K:0,J:1,L:h}};q.options=y;q.prototype.get=function(a,b){z(this,a,b)||d(new r(s.OUT_OF_BOUNDS));return A(this,a,b)};q.prototype.get=q.prototype.get;
q.prototype.set=function(a,b,c){z(this,a,b)||d(new r(s.OUT_OF_BOUNDS));v(c)||d(new r(s.INVALID_PARAMETERS,"Value has to be a number"));return B(this,a,b,c)};q.prototype.set=q.prototype.set;q.prototype.H=function(a,b){b=C(b,l);z(this,a,k)||d(new r(s.OUT_OF_BOUNDS));return D(this,a,b)};q.prototype.getRow=q.prototype.H;function D(a,b,c){for(var e=[],f=a.a().b,g=1;g<=f;g++)e.push(A(a,b,g));return c?new q(e,1):e}
q.prototype.Q=function(a,b){b=E(b);z(this,a,k)||d(new r(s.OUT_OF_BOUNDS));b.length!==this.a().b&&d(new r(s.INVALID_PARAMETERS,"Wrong number of columns in row."));return F(this,a,b)};q.prototype.setRow=q.prototype.Q;function F(a,b,c){for(var e=a.a().b,f=1;f<=e;f++)B(a,b,f,c[f-1]);return a}q.prototype.G=function(a,b){b=C(b,l);z(this,k,a)||d(new r(s.OUT_OF_BOUNDS));return G(this,a,b)};q.prototype.getColumn=q.prototype.G;
function G(a,b,c){for(var e=[],f=a.a().rows,g=1;g<=f;g++)e.push(A(a,g,b));return c?new q(e,k,1):e}q.prototype.P=function(a,b){b=E(b);z(this,k,a)||d(new r(s.OUT_OF_BOUNDS));b.length!==this.a().rows&&d(new r(s.INVALID_PARAMETERS,"Wrong number of rows in column"));return H(this,a,b)};q.prototype.setColumn=q.prototype.P;function H(a,b,c){for(var e=a.a().rows,f=1;f<=e;f++)B(a,f,b,c[f-1]);return a}q.prototype.d=function(){return 1===this.k("min")};q.prototype.isVector=q.prototype.d;
q.prototype.c=function(){return this.a().rows===this.a().b};q.prototype.isSquare=q.prototype.c;q.prototype.I=function(){this.c()||d(new r(s.DIMENSION_MISMATCH,"Matrix must be square"));for(var a=this.a().rows,b=2;b<=a;b++)for(var c=1;c<b;c++)if(A(this,b,c)!==A(this,c,b))return l;return h};q.prototype.isSymmetric=q.prototype.I;
q.prototype.g=function(a){a=I(a,y.g.mode);this.c()||d(new r(s.DIMENSION_MISMATCH,"Matrix must be square"));switch(a.toLowerCase()){case "lower":return J(this,l);case "upper":return J(this,h);case "both":return J(this,h)||J(this,l);default:d(new r(s.INVALID_PARAMETERS,"Mode not supported"))}};q.prototype.isTriangular=q.prototype.g;function J(a,b){for(var c=b?1:-1,e,f,g=a.a().rows,n=1;n<g;n++){e=a.diag(c*n);f=e.length;for(var t=0;t<f;t++)if(0!==e[t])return l}return h}
q.prototype.copy=function(){for(var a=this.a().rows,b=new q(a,this.a().b),c=1;c<=a;c++)F(b,c,D(this,c,l));return b};q.prototype.copy=q.prototype.copy;q.prototype.size=function(){return this.a().rows*this.a().b};q.prototype.size=q.prototype.size;q.prototype.k=function(a){var b=this.a();switch(a){case 1:case "rows":return b.rows;case 2:case "columns":return b.b;case "max":return Math.max(b.rows,b.b);case "min":return Math.min(b.rows,b.b);default:d(new r(s.INVALID_PARAMETERS,"Parameter must match a known value"))}};
q.prototype.dim=q.prototype.k;q.prototype.add=function(a){var b=this.a().rows,c=this.a().b;if(1<arguments.length)return b=[].slice.call(arguments),this.add.apply(Object(this.add(b.shift())),Object(b));(b!==a.a().rows||c!==a.a().b)&&d(new r(s.DIMENSION_MISMATCH,"Matrices must be of the same size"));for(var e=new q(b,c),f=1;f<=b;f++)for(var g=1;g<=c;g++)B(e,f,g,A(this,f,g)+A(a,f,g));return e};q.prototype.add=q.prototype.add;
q.prototype.m=function(a){var b=this.a().rows,c=this.a().b;if(1<arguments.length)return b=[].slice.call(arguments),this.m.apply(Object(this.m(b.shift())),Object(b));(b!==a.a().rows||c!==a.a().b)&&d(new r(s.DIMENSION_MISMATCH,"Matrices must be of the same size"));for(var e=new q(b,c),f=1;f<=b;f++)for(var g=1;g<=c;g++)B(e,f,g,A(this,f,g)-A(a,f,g));return e};q.prototype.subtract=q.prototype.m;
q.prototype.scale=function(a){v(a)||d(new r(s.INVALID_PARAMETERS,"Parameter must be a number"));for(var b=new q(this.a().rows,this.a().b),c=1;c<=this.a().rows;c++)for(var e=1;e<=this.a().b;e++)B(b,c,e,a*A(this,c,e));return b};q.prototype.scale=q.prototype.scale;
q.prototype.multiply=function(a){this.a().b!==a.a().rows&&d(new r(s.DIMENSION_MISMATCH,"Inner dimensions must match"));for(var b=new q(this.a().rows,a.a().b),c=1;c<=b.a().rows;c++)for(var e=1;e<=b.a().b;e++){for(var f=0,g=1;g<=this.a().b;g++)f+=A(this,c,g)*A(a,g,e);B(b,c,e,f)}return b};q.prototype.multiply=q.prototype.multiply;q.prototype.s=function(){for(var a=new q(this.a().b,this.a().rows),b=1;b<=this.a().rows;b++)H(a,b,D(this,b,l));return a};q.prototype.transpose=q.prototype.s;
q.prototype.trace=function(){this.c()||d(new r(s.DIMENSION_MISMATCH,"Matrix must be square"));for(var a=0,b=1;b<=this.a().rows;b++)a+=A(this,b,b);return a};q.prototype.trace=q.prototype.trace;
q.prototype.j=function(){var a=0,b=this.copy(),c,e,f,g=this.a().rows,n=this.a().b;for(f=1;f<=g;f++){e=0;var t=-1;for(c=f;c<=g;c++){var K=Math.abs(A(b,c,f));K>=t&&(e=c,t=K)}0===A(b,e,f)&&d(new r(s.MATRIX_IS_SINGULAR));e!==f&&(c=D(b,e,l),F(b,e,D(b,f,l)),F(b,f,c),a++);for(c=f+1;c<=g;c++){for(e=f+1;e<=n;e++)B(b,c,e,A(b,c,e)-A(b,f,e)*(A(b,c,f)/A(b,f,f)));B(b,c,f,0)}}b.S=a;return b};q.prototype.decomposeLU=q.prototype.j;
q.prototype.B=function(){var a,b;this.c()||d(new r(s.DIMENSION_MISMATCH,"Matrix must be square"));if(this.g())for(a=b=1;a<=this.a().rows;a++)b*=A(this,a,a);else{try{var c=this.j()}catch(e){if(e.code&&e.code===s.MATRIX_IS_SINGULAR)return 0;d(e)}b=Math.pow(-1,c.S);for(a=1;a<=this.a().rows;a++)b*=A(c,a,a)}return b};q.prototype.det=q.prototype.B;
q.prototype.inverse=function(){this.c()||d(new r(s.DIMENSION_MISMATCH,"Matrix must be square"));var a=this.i(L(this.a().rows)),b,c,e,f;try{a=a.j();for(c=a.a().rows;1<c;c--){b=D(a,c,l);var g=A(a,c-1,c)/A(a,c,c);for(f=0;f<b.length;f++)B(a,c-1,f+1,A(a,c-1,f+1)-b[f]*g)}for(e=1;e<=a.a().rows;e++){b=D(a,e,l);for(f=0;f<b.length;f++)b[f]/=A(a,e,e);F(a,e,b)}}catch(n){d(new r(s.MATRIX_IS_SINGULAR))}return a.r(1,a.a().rows,this.a().b+1,a.a().b)};q.prototype.inverse=q.prototype.inverse;
q.prototype.r=function(a,b,c,e){(!z(this,a,c)||!z(this,b,e)||a>b||c>e)&&d(new r(s.OUT_OF_BOUNDS));for(var f=new q(b-a+1,e-c+1),g=a;g<=b;g++){var n=D(this,g,l).slice(c-1,e);F(f,g-a+1,n)}return f};q.prototype.submatrix=q.prototype.r;q.prototype.i=function(a){this.a().rows!==a.a().rows&&d(new r(s.INVALID_PARAMETERS,"Number of rows must match"));for(var b=new q(this.a().rows,this.a().b+a.a().b),c=1;c<=this.a().b;c++)H(b,c,G(this,c,l));for(c=1;c<=a.a().b;c++)H(b,c+this.a().b,G(a,c,l));return b};
q.prototype.augment=q.prototype.i;q.prototype.D=function(a){(!this.d()||!a.d()||1!==this.a().b||1!==a.a().b)&&d(new r(s.INVALID_PARAMETERS,"Parameter must be a column vector"));this.a().rows!==a.a().rows&&d(new r(s.DIMENSION_MISMATCH));for(var b=0,c=1;c<=this.a().rows;c++)b+=A(this,c,1)*A(a,c,1);return b};q.prototype.dot=q.prototype.D;q.prototype.round=function(){return this.h(0)};q.prototype.round=q.prototype.round;
q.prototype.h=function(a){a=v(a)?a:y.h.C;var b=this.copy();a=Math.pow(10,a);for(var c=1;c<=b.a().rows;c++)for(var e=1;e<=b.a().b;e++)B(b,c,e,Math.round(A(b,c,e)*a)/a);return b};q.prototype.roundTo=q.prototype.h;q.prototype.abs=function(){for(var a=this.copy(),b=1;b<=a.a().rows;b++)for(var c=1;c<=a.a().b;c++)B(a,b,c,Math.abs(A(a,b,c)));return a};q.prototype.abs=q.prototype.abs;
q.prototype.A=function(a){(!this.d()||!a.d()||3!==this.a().rows||3!==a.a().rows)&&d(new r(s.INVALID_PARAMETERS,"Parameters must be three-dimensional column vectors"));return new q([[A(this,2,1)*A(a,3,1)-A(this,3,1)*A(a,2,1)],[A(this,3,1)*A(a,1,1)-A(this,1,1)*A(a,3,1)],[A(this,1,1)*A(a,2,1)-A(this,2,1)*A(a,1,1)]])};q.prototype.cross=q.prototype.A;q.prototype.w=function(a){a=E(a);for(var b=new q(this.a().rows+1,this.a().b),c=1;c<=this.a().rows;c++)F(b,c,D(this,c,l));F(b,this.a().rows+1,a);return b};
q.prototype.addRow=q.prototype.w;q.prototype.v=function(a){return this.copy().i(new q(E(a),k,1))};q.prototype.addColumn=q.prototype.v;q.prototype.contains=function(a,b){b=v(b)?b:0;(!v(a)||!v(b))&&d(new r(s.INVALID_PARAMETERS,"Parameter must be a number"));for(var c=1;c<=this.a().rows;c++)for(var e=1;e<=this.a().b;e++)if(0===b){if(A(this,c,e)===a)return h}else if(Math.abs(A(this,c,e)-a)<=b)return h;return l};q.prototype.contains=q.prototype.contains;
q.prototype.stringify=function(a,b){a=I(a,y.stringify.O);b=I(b,y.stringify.z);for(var c=[],e,f=1;f<=this.a().rows;f++){e=[];for(var g=1;g<=this.a().b;g++)e.push(A(this,f,g));c.push(e.join(b))}return c.join(a)};q.prototype.stringify=q.prototype.stringify;q.prototype.F=function(a){if(this.a().rows!==a.a().rows||this.a().b!==a.a().b)return l;for(var b=1;b<=this.a().rows;b++)for(var c=1;c<=this.a().b;c++)if(A(this,b,c)!==A(a,b,c))return l;return h};q.prototype.equals=q.prototype.F;
q.prototype.f=function(a,b){b=b||M.all;"function"!==typeof a&&d(new r(s.INVALID_PARAMETERS,"Applicator must be a function"));"function"!==typeof b&&d(new r(s.INVALID_PARAMETERS,"Filter must be a function"));for(var c=this.copy(),e,f=1;f<=c.a().rows;f++)for(var g=1;g<=c.a().b;g++)e=A(c,f,g),b(e,f,g)&&B(c,f,g,a(e,f,g));return c};q.prototype.fun=q.prototype.f;q.prototype.R=function(a){return this.f(a,M.nonZero)};q.prototype.spfun=q.prototype.R;q.prototype.M=function(){return this.f(N.exp,k)};
q.prototype.pw_exp=q.prototype.M;q.prototype.N=function(a){return this.f(function(b){return Math.pow(b,a)},k)};q.prototype.pw_pow=q.prototype.N;q.prototype.l=function(a,b){a=I(a,y.l.which);b=b||{};switch(a.toLowerCase()){case "p":case "pnorm":return this.e(Number(b));case "frobenius":return this.e(2);case "rows":case "rowsum":return this.q();case "columns":case "columnsum":return this.o();case "max":return this.p();default:d(new r(s.INVALID_PARAMETERS,"Norm not supported"))}};q.prototype.norm=q.prototype.l;
q.prototype.e=function(a){w(a)||d(new r(s.INVALID_PARAMETERS,"Parameter must be an integer"));for(var b=0,c=1;c<=this.a().rows;c++)for(var e=1;e<=this.a().b;e++)b+=Math.pow(Math.abs(A(this,c,e)),a);return Math.pow(b,1/a)};q.prototype.pnorm=q.prototype.e;q.prototype.p=function(){for(var a=0,b=1;b<=this.a().rows;b++)for(var c=1;c<=this.a().b;c++)a=Math.max(a,Math.abs(A(this,b,c)));return a};q.prototype.maxnorm=q.prototype.p;
q.prototype.q=function(){for(var a=0,b=1;b<=this.a().rows;b++)a=Math.max(a,D(this,b,h).e(1));return a};q.prototype.rownorm=q.prototype.q;q.prototype.o=function(){for(var a=0,b=1;b<=this.a().b;b++)a=Math.max(a,G(this,b,h).e(1));return a};q.prototype.columnnorm=q.prototype.o;q.prototype.diag=function(a){a=v(a)?a:0;var b=[],c=-Math.min(a,0);a=Math.max(a,0);var e=0===c?this.a().b-a:this.a().rows-c;0>=e&&d(new r(s.OUT_OF_BOUNDS));for(var f=1;f<=e;f++)b.push(A(this,f+c,f+a));return b};
q.prototype.diag=q.prototype.diag;Array.prototype.n=function(a,b){return new q(this,a,b)};p("Array.prototype.toMatrix",Array.prototype.n);Array.prototype.T=function(a){a=C(a,l);return new q(this,a?1:this.length,a?this.length:1)};p("Array.prototype.toVector",Array.prototype.T);
String.prototype.n=function(a,b){a=I(a,"\r\n");b=I(b,"\t");for(var c=this.split(a),e,f=0,g=new q(0),n=0;n<c.length;n++){e=c[n].split(b);0===f&&(f=e.length,g=new q(c.length,f));e.length!==f&&d(new r(s.INVALID_PARAMETERS,"Number of columns is inconsistent"));for(var t=1;t<=f;t++)B(g,n+1,t,Number(e[t-1]))}return g};p("String.prototype.toMatrix",String.prototype.n);function A(a,b,c){return a.t(a.a().b*(b-1)+c-1)}function B(a,b,c,e){return a.u(a.a().b*(b-1)+c-1,e)}
function z(a,b,c){return(!v(b)||1<=b&&b<=a.a().rows)&&(!v(c)||1<=c&&c<=a.a().b)}function v(a){return"number"===typeof a}function w(a){return v(a)&&(a|0)===a}function u(a){for(var b=0;b<a.length;b++)if(!v(a[b]))return l;return h}function E(a){if(!(a instanceof q))return a;a.d()||d(new r(s.DIMENSION_MISMATCH,"Argument has to be vector"));var b=a.copy();a.k("max")!==a.a().rows&&(b=b.s());a=[];for(var c=1;c<=b.a().rows;c++)a.push(A(b,c,1));return a}function I(a,b){return"string"===typeof a?a:b}
function C(a,b){return"boolean"===typeof a?a:b}function r(a,b){this.name="MatrixError";this.code=a;this.message=b;this.toString=function(){return this.name+" ["+this.code+"]: "+(this.message||"No message")}}q.MatrixError=r;var s={INVALID_PARAMETERS:"Invalid parameters",OUT_OF_BOUNDS:"Out of bounds",DIMENSION_MISMATCH:"Dimension mismatch",MATRIX_IS_SINGULAR:"Matrix is singular"};q.ErrorCodes=s;var M={all:function(){return h},nonZero:function(a){return 0!==a},diag:function(a,b,c){return b===c}};
q.filters=M;var N={exp:function(a){return Math.exp(a)},square:function(a){return a*a}};q.applicators=N;q.zeros=function(a,b){b=v(b)?b:a;return new q(a,b)};q.ones=function(a,b){b=v(b)?b:a;for(var c=new q(a,b),e=1;e<=a;e++)for(var f=1;f<=b;f++)B(c,e,f,1);return c};function L(a){for(var b=new q(a,a),c=1;c<=a;c++)B(b,c,c,1);return b}q.eye=L;
q.diag=function(a,b){a=E(a);b=v(b)?b:0;for(var c=new q(a.length+Math.abs(b)),e=-Math.min(b,0),f=Math.max(b,0),g=1;g<=c.a().rows-Math.abs(b);g++)B(c,g+e,g+f,a[g-1]);return c};q.diag=q.diag;q.random=function(a,b,c,e,f){b=v(b)?b:a;c=v(c)?c:y.random.K;e=v(e)?e:y.random.J;f=C(f,y.random.L);a=new q(a,b);e=e-c+(f?1:0);for(var g=1;g<=a.a().rows;g++)for(var n=1;n<=a.a().b;n++)b=c+Math.random()*e,f&&(b|=0),B(a,g,n,b);return a};q.linspace=function(a,b,c){c=v(c)?c:1;for(var e=[];a<=b;a+=c)e.push(a);return e};
function x(a,b){for(var c=[],e=1;e<=a;e++)c[e-1]=b;return c}q.repeat=x;
