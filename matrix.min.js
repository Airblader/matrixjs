function e(a){throw a;}var k=!0,l=null,m=!1,p=this;Math.random();function q(a,b){var c=a.split("."),d=p;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)!c.length&&void 0!==b?d[f]=b:d=d[f]?d[f]:d[f]={}};function r(){this.constructor=l;this.c=function(){return l};this.e=function(){return this};this.a=function(){return{rows:l,b:l}};e(Error("MatrixCommon cannot be instantiated"))}q("MatrixCommon",r);function s(){e(Error("This cannot be instantiated"))}q("MatrixUtils",s);function u(a,b){this.name="MatrixError";this.code=a;this.message=b;this.toString=function(){return this.name+" ["+this.code+"]: "+(this.message||"No message")}}q("MatrixError",u);
var v={INVALID_PARAMETERS:"Invalid parameters",OUT_OF_BOUNDS:"Out of bounds",DIMENSION_MISMATCH:"Dimension mismatch",MATRIX_IS_SINGULAR:"Matrix is singular",UNKNOWN_TYPE:"Unknown type"};u.ErrorCodes=v;
function w(a){var b=[].slice.call(arguments),c,d,f=[];this.c=function(a,b){return f[d*(a-1)+b-1]};this.e=function(a,b,c){f[d*(a-1)+b-1]=c;return this};this.a=function(){return{rows:c,b:d}};(function(){if(1===b.length&&b[0]instanceof Array&&0!==b[0].length&&b[0][0]instanceof Array){c=b[0].length;d=-1;for(var a=0;a<b[0].length;a++)b[0][a].length!==d&&-1!==d&&e(new u(v.INVALID_PARAMETERS,"Number of columns must be the same for all rows")),x(b[0][a])||e(new u(v.INVALID_PARAMETERS,"Elements must be numbers")),
d=Math.max(d,b[0][a].length),f=f.concat(b[0][a])}else if(1<=b.length&&3>=b.length&&b[0]instanceof Array&&(0===b[0].length||y(b[0][0]))){x(b[0])||e(new u(v.INVALID_PARAMETERS,"Elements must be numbers"));f=b[0];var a=b[1],g=b[2];!y(a)&&!y(g)?a=g=Math.sqrt(f.length):!y(a)&&A(g)?a=f.length/g:A(a)&&!y(g)&&(g=f.length/a);(!A(a)||!A(g))&&e(new u(v.OUT_OF_BOUNDS,"Array must represent square matrix if no size is given"));c=a;d=g}else 1===b.length&&A(b[0])?(c=b[0],d=b[0],f=B(c*d,0)):2===b.length&&A(b[0])&&
A(b[1])?(c=b[0],d=b[1],f=B(c*d,0)):e(new u(v.INVALID_PARAMETERS,"Parameters must match a supported signature"))})();return this}q("Matrix",w);w.prototype=Object.create(r.prototype);w.prototype.constructor=w;function C(){e(Error("Not yet implemented."))}q("SparseMatrix",C);C.prototype=Object.create(r.prototype);C.prototype.constructor=C;
q("Vector",function(a){[].slice.call(arguments);var b=[];this.c=function(a,d){return b[d-1]};this.e=function(a,d,f){b[d-1]=f;return this};this.a=function(){return{rows:1,b:b.length}};return this});var D={stringify:{S:"\r\n",D:"\t"},l:{mode:"both"},m:{H:0},r:{which:"max"},random:{O:0,N:1,P:k}};r.options=D;r.prototype.d=function(a,b){var c=this.constructor;if(a.j&&this.q())for(var d=0;d<a.j.length;d++)a.j[d].q()||(c=w);return new (c.bind.apply(c,[l].concat([].slice.call(arguments,1))))};
r.prototype.get=function(a,b){this.f(a,b)||e(new u(v.OUT_OF_BOUNDS));return this.c(a,b)};r.prototype.get=r.prototype.get;r.prototype.set=function(a,b,c){this.f(a,b)||e(new u(v.OUT_OF_BOUNDS));y(c)||e(new u(v.INVALID_PARAMETERS,"Value has to be a number"));return this.e(a,b,c)};r.prototype.set=r.prototype.set;r.prototype.L=function(a,b){b=E(b,m);this.f(a,l)||e(new u(v.OUT_OF_BOUNDS));return F(this,a,b)};r.prototype.getRow=r.prototype.L;
function F(a,b,c){for(var d=[],f=a.a().b,h=1;h<=f;h++)d.push(a.c(b,h));return c?a.d({},d,1):d}r.prototype.U=function(a,b){b=H(b);this.f(a,l)||e(new u(v.OUT_OF_BOUNDS));b.length!==this.a().b&&e(new u(v.INVALID_PARAMETERS,"Wrong number of columns in row."));return I(this,a,b)};r.prototype.setRow=r.prototype.U;function I(a,b,c){for(var d=a.a().b,f=1;f<=d;f++)a.e(b,f,c[f-1]);return a}r.prototype.K=function(a,b){b=E(b,m);this.f(l,a)||e(new u(v.OUT_OF_BOUNDS));return J(this,a,b)};
r.prototype.getColumn=r.prototype.K;function J(a,b,c){for(var d=[],f=a.a().rows,h=1;h<=f;h++)d.push(a.c(h,b));return c?a.d({},d,l,1):d}r.prototype.T=function(a,b){b=H(b);this.f(l,a)||e(new u(v.OUT_OF_BOUNDS));b.length!==this.a().rows&&e(new u(v.INVALID_PARAMETERS,"Wrong number of rows in column"));return K(this,a,b)};r.prototype.setColumn=r.prototype.T;function K(a,b,c){for(var d=a.a().rows,f=1;f<=d;f++)a.e(f,b,c[f-1]);return a}r.prototype.q=function(){return this instanceof C};
r.prototype.isSparse=r.prototype.q;r.prototype.i=function(){return 1===this.p("min")};r.prototype.isVector=r.prototype.i;r.prototype.h=function(){return this.a().rows===this.a().b};r.prototype.isSquare=r.prototype.h;r.prototype.M=function(){this.h()||e(new u(v.DIMENSION_MISMATCH,"Matrix must be square"));for(var a=this.a().rows,b=2;b<=a;b++)for(var c=1;c<b;c++)if(this.c(b,c)!==this.c(c,b))return m;return k};r.prototype.isSymmetric=r.prototype.M;
r.prototype.l=function(a){a=L(a,D.l.mode);this.h()||e(new u(v.DIMENSION_MISMATCH,"Matrix must be square"));switch(a.toLowerCase()){case "lower":return M(this,m);case "upper":return M(this,k);case "both":return M(this,k)||M(this,m);default:e(new u(v.INVALID_PARAMETERS,"Mode not supported"))}};r.prototype.isTriangular=r.prototype.l;function M(a,b){for(var c=b?1:-1,d,f,h=a.a().rows,g=1;g<h;g++){d=a.diag(c*g);f=d.length;for(var n=0;n<f;n++)if(0!==d[n])return m}return k}
r.prototype.copy=function(){for(var a=this.a().rows,b=this.d({},a,this.a().b),c=1;c<=a;c++)I(b,c,F(this,c,m));return b};r.prototype.copy=r.prototype.copy;r.prototype.size=function(){var a=this.a();return a.rows*a.b};r.prototype.size=r.prototype.size;r.prototype.p=function(a){var b=this.a();switch(a){case 1:case "rows":return b.rows;case 2:case "columns":return b.b;case "max":return Math.max(b.rows,b.b);case "min":return Math.min(b.rows,b.b);default:e(new u(v.INVALID_PARAMETERS,"Parameter must match a known value"))}};
r.prototype.dim=r.prototype.p;r.prototype.add=function(a){var b=this.a(),c=b.rows,b=b.b;if(1<arguments.length)return c=[].slice.call(arguments),this.add.apply(Object(this.add(c.shift())),Object(c));(c!==a.a().rows||b!==a.a().b)&&e(new u(v.DIMENSION_MISMATCH,"Matrices must be of the same size"));for(var d=this.d({j:[a]},c,b),f,h,g=1;g<=c;g++){f=F(this,g,m);h=F(a,g,m);for(var n=0;n<b;n++)f[n]+=h[n];I(d,g,f)}return d};r.prototype.add=r.prototype.add;
r.prototype.s=function(a){var b=this.a().rows,c=this.a().b;if(1<arguments.length)return b=[].slice.call(arguments),this.s.apply(Object(this.s(b.shift())),Object(b));(b!==a.a().rows||c!==a.a().b)&&e(new u(v.DIMENSION_MISMATCH,"Matrices must be of the same size"));for(var d=this.d({j:[a]},b,c),f,h,g=1;g<=b;g++){f=F(this,g,m);h=F(a,g,m);for(var n=0;n<c;n++)f[n]-=h[n];I(d,g,f)}return d};r.prototype.subtract=r.prototype.s;
r.prototype.scale=function(a){y(a)||e(new u(v.INVALID_PARAMETERS,"Parameter must be a number"));for(var b=this.a().rows,c=this.a().b,d=this.d({},b,c),f,h=1;h<=b;h++){f=F(this,h,m);for(var g=0;g<c;g++)f[g]*=a;I(d,h,f)}return d};r.prototype.scale=r.prototype.scale;
r.prototype.multiply=function(a){var b=this.a(),c=b.rows,b=b.b,d=a.a().b;b!==a.a().rows&&e(new u(v.DIMENSION_MISMATCH,"Inner dimensions must match"));for(var f=this.d({j:[a]},c,d),h=1;h<=c;h++)for(var g=1;g<=d;g++){for(var n=0,t=F(this,h,m),z=J(a,g,m),G=0;G<b;G++)n+=t[G]*z[G];f.e(h,g,n)}return f};r.prototype.multiply=r.prototype.multiply;r.prototype.A=function(){for(var a=this.a().rows,b=this.d({},this.a().b,a),c=1;c<=a;c++)K(b,c,F(this,c,m));return b};r.prototype.transpose=r.prototype.A;
r.prototype.trace=function(){this.h()||e(new u(v.DIMENSION_MISMATCH,"Matrix must be square"));for(var a=this.a().rows,b=0,c=1;c<=a;c++)b+=this.c(c,c);return b};r.prototype.trace=r.prototype.trace;
r.prototype.o=function(){var a=0,b=this.copy(),c,d,f,h,g,n=this.a().rows,t=this.a().b,z;for(f=1;f<=n;f++){d=0;g=-1;h=J(b,f,m);for(c=f;c<=n;c++)z=Math.abs(h[c-1]),z>=g&&(d=c,g=z);0===h[d-1]&&e(new u(v.MATRIX_IS_SINGULAR));d!==f&&(c=F(b,d,m),I(b,d,F(b,f,m)),I(b,f,c),a++);h=F(b,f,m);for(c=f+1;c<=n;c++){g=F(b,c,m);for(d=f;d<t;d++)g[d]-=h[d]*g[f-1]/h[f-1];g[f-1]=0;I(b,c,g)}}b.W=a;return b};r.prototype.decomposeLU=r.prototype.o;
r.prototype.G=function(){var a,b,c,d=this.a().rows;this.h()||e(new u(v.DIMENSION_MISMATCH,"Matrix must be square"));if(this.l())b=1,c=this.diag();else{try{a=this.o()}catch(f){if(f.code&&f.code===v.MATRIX_IS_SINGULAR)return 0;e(f)}b=Math.pow(-1,a.W);c=a.diag()}for(a=0;a<d;a++)b*=c[a];return b};r.prototype.det=r.prototype.G;
r.prototype.inverse=function(){this.h()||e(new u(v.DIMENSION_MISMATCH,"Matrix must be square"));var a=this.n(N(this.a().rows)),b,c,d,f,h,g,n,t,z;try{a=a.o();t=a.a().rows;z=a.a().b;for(f=t;1<f;f--){c=F(a,f-1,m);b=F(a,f,m);n=c[f-1]/b[f-1];d=[];for(g=0;g<z;g++)d[g]=c[g]-b[g]*n;I(a,f-1,d)}for(h=1;h<=t;h++){b=F(a,h,m);d=[];for(g=0;g<z;g++)d[g]=b[g]/b[h-1];I(a,h,d)}}catch(G){e(new u(v.MATRIX_IS_SINGULAR))}return a.z(1,a.a().rows,this.a().b+1,a.a().b)};r.prototype.inverse=r.prototype.inverse;
r.prototype.z=function(a,b,c,d){(!this.f(a,c)||!this.f(b,d)||a>b||c>d)&&e(new u(v.OUT_OF_BOUNDS));for(var f=this.d({},b-a+1,d-c+1),h=a;h<=b;h++)I(f,h-a+1,F(this,h,m).slice(c-1,d));return f};r.prototype.submatrix=r.prototype.z;r.prototype.n=function(a){var b=this.a().b,c=a.a().b;this.a().rows!==a.a().rows&&e(new u(v.INVALID_PARAMETERS,"Number of rows must match"));for(var d=this.d({j:[a]},this.a().rows,b+c),f=1;f<=b;f++)K(d,f,J(this,f,m));for(b=1;b<=c;b++)K(d,b+this.a().b,J(a,b,m));return d};
r.prototype.augment=r.prototype.n;r.prototype.I=function(a){var b=this.a().rows;(!this.i()||!a.i()||1!==this.a().b||1!==a.a().b)&&e(new u(v.INVALID_PARAMETERS,"Parameter must be a column vector"));b!==a.a().rows&&e(new u(v.DIMENSION_MISMATCH));for(var c=0,d=1;d<=b;d++)c+=this.c(d,1)*a.c(d,1);return c};r.prototype.dot=r.prototype.I;r.prototype.round=function(){return this.m(0)};r.prototype.round=r.prototype.round;
r.prototype.m=function(a){a=y(a)?a:D.m.H;var b=Math.pow(10,a);return this.g(function(a){return Math.round(a*b)/b})};r.prototype.roundTo=r.prototype.m;r.prototype.abs=function(){return this.g(function(a){return Math.abs(a)})};r.prototype.abs=r.prototype.abs;
r.prototype.F=function(a){(!this.i()||!a.i()||3!==this.a().rows||3!==a.a().rows)&&e(new u(v.INVALID_PARAMETERS,"Parameters must be three-dimensional column vectors"));return this.d({},[[this.c(2,1)*a.c(3,1)-this.c(3,1)*a.c(2,1)],[this.c(3,1)*a.c(1,1)-this.c(1,1)*a.c(3,1)],[this.c(1,1)*a.c(2,1)-this.c(2,1)*a.c(1,1)]])};r.prototype.cross=r.prototype.F;r.prototype.C=function(a){a=H(a);for(var b=this.a().rows,c=this.d({},b+1,this.a().b),d=1;d<=b;d++)I(c,d,F(this,d,m));I(c,b+1,a);return c};
r.prototype.addRow=r.prototype.C;r.prototype.B=function(a){return this.copy().n(this.d({},H(a),l,1))};r.prototype.addColumn=r.prototype.B;r.prototype.contains=function(a,b){b=y(b)?b:0;var c=this.a().rows,d=this.a().b,f;(!y(a)||!y(b))&&e(new u(v.INVALID_PARAMETERS,"Parameter must be a number"));for(var h=1;h<=c;h++){f=F(this,h,m);for(var g=0;g<d;g++)if(0===b){if(f[g]===a)return k}else if(Math.abs(f[g]-a)<=b)return k}return m};r.prototype.contains=r.prototype.contains;
r.prototype.stringify=function(a,b){a=L(a,D.stringify.S);b=L(b,D.stringify.D);for(var c=[],d,f=this.a().rows,h=1;h<=f;h++)d=F(this,h,m),c.push(d.join(b));return c.join(a)};r.prototype.stringify=r.prototype.stringify;r.prototype.J=function(a){var b=this.a().rows,c=this.a().b,d,f;if(b!==a.a().rows||c!==a.a().b)return m;for(var h=1;h<=b;h++){d=F(this,h,m);f=F(a,h,m);for(var g=0;g<c;g++)if(d[g]!==f[g])return m}return k};r.prototype.equals=r.prototype.J;
r.prototype.g=function(a,b){b=b||O.all;"function"!==typeof a&&e(new u(v.INVALID_PARAMETERS,"Applicator must be a function"));"function"!==typeof b&&e(new u(v.INVALID_PARAMETERS,"Filter must be a function"));var c,d;c=this.a();for(var f=c.rows,h=c.b,g=this.d({},f,h),n=1;n<=f;n++){d=F(this,n,m);for(var t=1;t<=h;t++)c=d[t-1],b(c,n,t)&&(d[t-1]=a(c,n,t));I(g,n,d)}return g};r.prototype.fun=r.prototype.g;r.prototype.V=function(a){return this.g(a,O.nonZero)};r.prototype.spfun=r.prototype.V;
r.prototype.Q=function(){return this.g(P.exp,l)};r.prototype.pw_exp=r.prototype.Q;r.prototype.R=function(a){return this.g(function(b){return Math.pow(b,a)},l)};r.prototype.pw_pow=r.prototype.R;
r.prototype.r=function(a,b){a=L(a,D.r.which);b=b||{};switch(a.toLowerCase()){case "p":case "pnorm":return this.k(Number(b));case "frobenius":return this.k(2);case "rows":case "rowsum":return this.w();case "columns":case "columnsum":return this.u();case "max":return this.v();default:e(new u(v.INVALID_PARAMETERS,"Norm not supported"))}};r.prototype.norm=r.prototype.r;
r.prototype.k=function(a){A(a)||e(new u(v.INVALID_PARAMETERS,"Parameter must be an integer"));for(var b=0,c=this.a().rows,d=this.a().b,f,h=1;h<=c;h++){f=F(this,h,m);for(var g=0;g<d;g++)b+=Math.pow(Math.abs(f[g]),a)}return Math.pow(b,1/a)};r.prototype.pnorm=r.prototype.k;r.prototype.v=function(){for(var a=0,b=this.a().rows,c=this.a().b,d,f=1;f<=b;f++){d=F(this,f,m);for(var h=0;h<c;h++)a=Math.max(a,Math.abs(d[h]))}return a};r.prototype.maxnorm=r.prototype.v;
r.prototype.w=function(){for(var a=0,b=this.a().rows,c=1;c<=b;c++)a=Math.max(a,F(this,c,k).k(1));return a};r.prototype.rownorm=r.prototype.w;r.prototype.u=function(){for(var a=0,b=this.a().b,c=1;c<=b;c++)a=Math.max(a,J(this,c,k).k(1));return a};r.prototype.columnnorm=r.prototype.u;r.prototype.diag=function(a){a=y(a)?a:0;var b=[],c=-Math.min(a,0);a=Math.max(a,0);var d=0===c?this.a().b-a:this.a().rows-c;0>=d&&e(new u(v.OUT_OF_BOUNDS));for(var f=1;f<=d;f++)b.push(this.c(f+c,f+a));return b};
r.prototype.diag=r.prototype.diag;r.prototype.f=function(a,b){return(!y(a)||1<=a&&a<=this.a().rows)&&(!y(b)||1<=b&&b<=this.a().b)};r.prototype.isInRange=r.prototype.f;r.prototype.X=function(){for(var a=this.a().rows,b=[],c=1;c<=a;c++)b=b.concat(F(this,c,m));return b};r.prototype.toArray=r.prototype.X;w.zeros=function(a,b){b=y(b)?b:a;return new w(a,b)};w.ones=function(a,b){b=y(b)?b:a;for(var c=new w(a,b),d=1;d<=a;d++)for(var f=1;f<=b;f++)c.e(d,f,1);return c};
function N(a){for(var b=new w(a,a),c=1;c<=a;c++)b.e(c,c,1);return b}w.eye=N;w.diag=function(a,b){a=H(a);b=y(b)?b:0;for(var c=new w(a.length+Math.abs(b)),d=-Math.min(b,0),f=Math.max(b,0),h=c.a().rows-Math.abs(b),g=1;g<=h;g++)c.e(g+d,g+f,a[g-1]);return c};w.diag=w.diag;w.random=function(a,b,c,d,f){b=y(b)?b:a;c=y(c)?c:D.random.O;d=y(d)?d:D.random.N;f=E(f,D.random.P);var h=new w(a,b);d=d-c+(f?1:0);for(var g,n=1;n<=a;n++)for(var t=1;t<=b;t++)g=c+Math.random()*d,f&&(g|=0),h.e(n,t,g);return h};
function y(a){return"number"===typeof a}function A(a){return y(a)&&(a|0)===a}function x(a){for(var b=0;b<a.length;b++)if(!y(a[b]))return m;return k}s.linspace=function(a,b,c){c=y(c)?c:1;for(var d=[];a<=b;a+=c)d.push(a);return d};function B(a,b){for(var c=[],d=1;d<=a;d++)c[d-1]=b;return c}s.repeat=B;
function H(a){if(!(a instanceof r))return a;a.i()||e(new u(v.DIMENSION_MISMATCH,"Argument has to be vector"));var b=a.copy();a.p("max")!==a.a().rows&&(b=b.A());a=[];for(var c=b.a().rows,d=1;d<=c;d++)a.push(b.c(d,1));return a}function L(a,b){return"string"===typeof a?a:b}function E(a,b){return"boolean"===typeof a?a:b}var O={all:function(){return k},nonZero:function(a){return 0!==a},diag:function(a,b,c){return b===c}};s.filters=O;
var P={exp:function(a){return Math.exp(a)},square:function(a){return a*a}};s.applicators=P;Array.prototype.t=function(a,b){return new w(this,a,b)};q("Array.prototype.toMatrix",Array.prototype.t);Array.prototype.Y=function(a){a=E(a,m);return new w(this,a?1:this.length,a?this.length:1)};q("Array.prototype.toVector",Array.prototype.Y);
String.prototype.t=function(a,b){a=L(a,"\r\n");b=L(b,"\t");for(var c=this.split(a),d,f=0,h=new w(0),g=0;g<c.length;g++){d=c[g].split(b);0===f&&(f=d.length,h=new w(c.length,f));d.length!==f&&e(new u(v.INVALID_PARAMETERS,"Number of columns is inconsistent"));for(var n=1;n<=f;n++)h.e(g+1,n,Number(d[n-1]))}return h};q("String.prototype.toMatrix",String.prototype.t);
